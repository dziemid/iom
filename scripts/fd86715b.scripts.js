"use strict";function splitLine(a,b){for(var c="",d=a;d.length>b;){var e=d.substring(0,b),f=e.lastIndexOf(" "),g=e.lastIndexOf("\n");-1!=g&&(f=g),-1==f&&(f=b),c+=e.substring(0,f)+"\n",d=d.substring(f+1)}return c+d}function setCaretPosition(a,b){if(a.setSelectionRange)a.focus(),a.setSelectionRange(b,b);else if(a.createTextRange){var c=a.createTextRange();c.collapse(!0),c.moveEnd("character",b),c.moveStart("character",b),c.select()}}function initialState(){var a=localStorage.getItem("iom");return null!=a&&""!=a?a:(introJs().start(),"Goal \n    Critical success factor 1\n        Necessary Condition 1\n    Critical success factor 2\n        Necessary Condition 2\n    Critical success factor 3\n        Necessary Condition 2\n        Necessary Condition 3\n  ")}angular.module("iomApp",["ngCookies","ngResource","ngSanitize","ngRoute","ui.keypress"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).otherwise({redirectTo:"/"})}]),console.log(introJs());var IDENT=4;String.prototype.repeat=function(a){return new Array(a+1).join(this)},angular.module("iomApp").controller("MainCtrl",["$scope","$sce",function(a,b){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"],a.keypressCallback=function(b){var c=b.target.selectionStart;if(console.log(b.target),9==b.which){var d=[a.spaceFormat.slice(0,c)," ".repeat(IDENT),a.spaceFormat.slice(c)].join("");b.target.value=d,setCaretPosition(b.target,c+IDENT)}if(13==b.which){var e=b.target.value.split("\n"),f=b.target.value.substr(0,b.target.selectionStart).split("\n").length-1,g=e[f].trimLeft(),h=(e[f].length-g.length)/IDENT;console.log(g+h);var d=[a.spaceFormat.slice(0,c),"\n"+" ".repeat(h*IDENT),a.spaceFormat.slice(c)].join("");b.target.value=d,setCaretPosition(b.target,c+1+h*IDENT)}a.spaceFormat=b.target.value,b.preventDefault()},a.spaceFormat=initialState(),a.svg="loading...",a.$watch("spaceFormat",_.debounce(function(){a.$apply(function(){a.redraw()})},400)),a.redraw=function(){var c=a.spaceFormat;localStorage.setItem("iom",c);var d=c.replace(/\"/g,"'").split("\n"),e=null,f=null,g=0,h=null,i=null,j=d.length,k=null,l=null,m=new Array;a.dotFormat="digraph testgraph{ \n                 node [ shape=box, fontname=Arial, fontcolor=blue, fontsize=9];         graph [  ];         ";for(var n=0;j>n;n++)e=d[n],f=e.trimLeft(),g=(e.length-f.length)/IDENT,f=splitLine(f,22),m[g]=f,0==g&&(k=f),g>h&&(k=i,l=f),h==g&&(l=f),h>g&&(k=m[g-1],l=f),null!=k&&null!=l&&""!=k&&""!=l&&(a.dotFormat+='"'+k+'" -> "'+l+'"\n'),h=g,i=f;a.dotFormat+="}",a.svg=b.trustAsHtml(Viz(a.dotFormat,"svg"))}}]);